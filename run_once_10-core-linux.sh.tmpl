#!/usr/bin/env bash
set -e

{{ if eq .chezmoi.os "linux" -}}

# Base tools
sudo apt update

sudo apt install -y \
  gpg \
  ripgrep \
  gnome-tweaks \
  gparted \
  dconf-editor \
  cmake \
  g++ \
  pkg-config \
  libfontconfig1-dev \
  libxcb-xfixes0-dev \
  libxkbcommon-dev \
  python3 \
  fzf

# eza repo (only if not already present)
if [ ! -f /etc/apt/sources.list.d/gierens.list ]; then
  sudo mkdir -p /etc/apt/keyrings
  sudo apt install -y wget
  wget -qO- https://raw.githubusercontent.com/eza-community/eza/main/deb.asc \
    | sudo gpg --dearmor -o /etc/apt/keyrings/gierens.gpg
  echo "deb [signed-by=/etc/apt/keyrings/gierens.gpg] http://deb.gierens.de stable main" \
    | sudo tee /etc/apt/sources.list.d/gierens.list
  sudo chmod 644 /etc/apt/keyrings/gierens.gpg /etc/apt/sources.list.d/gierens.list
  sudo apt update
fi

sudo apt install -y eza

# Zed
if ! command -v zed >/dev/null 2>&1; then
  curl -f https://zed.dev/install.sh | sh
fi

curl -fsSL https://tailscale.com/install.sh | sh


{{ end -}}

